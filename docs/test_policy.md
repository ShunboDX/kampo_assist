# テスト方針（request / system の使い分け）

## 目的
- 認証・認可を含む重要な画面の安全性を担保する
- UI変更に強いテストと、ユーザー体験を保証するテストを役割分担する

## request spec を使うケース
- ログイン必須ページのアクセス制御（未ログイン時のリダイレクト等）
- 本人のみアクセス可能なページの認可（403/リダイレクト等）
- HTTPステータス、リダイレクト先、テンプレートの確認

### 例
- 未ログインでアクセス → 302でログインへ
- 他人のリソースへアクセス → 403（またはトップへリダイレクト）

## system spec を使うケース
- ユーザー操作の一連フロー（入力・クリック・遷移・表示）を確認したいとき
- 主要なユーザーストーリー（お気に入り、検索履歴保存など）

### 方針
- system spec は「成功フロー中心」に絞り、認可の細かい分岐は request spec で担保する

---

# 認証が絡む画面のテスト方針

## 基本方針
- 認証・認可の境界は request spec で担保する
- system spec ではログイン処理をヘルパー化し、主要フローの確認に集中する

## 観点
- 未ログイン時：ログインへ誘導されること
- 権限不足時：アクセス不可（403またはリダイレクト）になること
- 本人のみ：本人はアクセス可、他人は不可
